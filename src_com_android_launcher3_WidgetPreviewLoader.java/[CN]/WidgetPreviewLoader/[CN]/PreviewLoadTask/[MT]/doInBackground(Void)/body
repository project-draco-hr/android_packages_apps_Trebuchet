{
  Bitmap unusedBitmap=null;
synchronized (mUnusedBitmaps) {
    if (isCancelled()) {
      return null;
    }
    for (    Bitmap candidate : mUnusedBitmaps) {
      if (candidate != null && candidate.isMutable() && candidate.getWidth() == mPreviewWidth && candidate.getHeight() == mPreviewHeight) {
        unusedBitmap=candidate;
        break;
      }
    }
    if (unusedBitmap == null) {
      unusedBitmap=Bitmap.createBitmap(mPreviewWidth,mPreviewHeight,Config.ARGB_8888);
    }
 else {
      mUnusedBitmaps.remove(unusedBitmap);
    }
  }
  if (isCancelled()) {
    return unusedBitmap;
  }
  Bitmap preview=readFromDb(mKey,unusedBitmap,this);
  if (!isCancelled() && preview == null) {
    mVersions=getPackageVersion(mKey.componentName.getPackageName());
    Launcher launcher=(Launcher)mCaller.getContext();
    preview=generatePreview(launcher,mInfo,unusedBitmap,mPreviewWidth,mPreviewHeight);
  }
  return preview;
}
