{
  boolean consume=FocusLogic.shouldConsume(keyCode);
  if (e.getAction() == KeyEvent.ACTION_UP) {
    return consume;
  }
  if (DEBUG) {
    Log.v(TAG,String.format("Handle ALL APPS and Folders keyevent=[%s].",KeyEvent.keyCodeToString(keyCode)));
  }
  ViewGroup parentLayout;
  ViewGroup itemContainer;
  int countX;
  int countY;
  if (v.getParent() instanceof ShortcutAndWidgetContainer) {
    itemContainer=(ViewGroup)v.getParent();
    parentLayout=(ViewGroup)itemContainer.getParent();
    countX=((CellLayout)parentLayout).getCountX();
    countY=((CellLayout)parentLayout).getCountY();
  }
 else {
    if (LauncherAppState.isDogfoodBuild()) {
      throw new IllegalStateException("Parent of the focused item is not supported.");
    }
 else {
      return false;
    }
  }
  final int iconIndex=itemContainer.indexOfChild(v);
  final PagedView container=(PagedView)parentLayout.getParent();
  final int pageIndex=container.indexToPage(container.indexOfChild(parentLayout));
  final int pageCount=container.getChildCount();
  ViewGroup newParent=null;
  View child=null;
  int[][] matrix=FocusLogic.createFullMatrix(countX,countY,true);
  int newIconIndex=FocusLogic.handleKeyEvent(keyCode,countX,countY,matrix,iconIndex,pageIndex,pageCount);
  if (newIconIndex == FocusLogic.NOOP) {
    handleNoopKey(keyCode,v);
    return consume;
  }
switch (newIconIndex) {
case FocusLogic.PREVIOUS_PAGE_RIGHT_COLUMN:
case FocusLogic.NEXT_PAGE_RIGHT_COLUMN:
    int newPageIndex=pageIndex - 1;
  if (newIconIndex == FocusLogic.NEXT_PAGE_RIGHT_COLUMN) {
    newPageIndex=pageIndex + 1;
  }
newParent=getAppsCustomizePage(container,newPageIndex);
if (newParent != null) {
int row=FocusLogic.findRow(matrix,iconIndex);
container.snapToPage(newPageIndex);
child=newParent.getChildAt(matrix[countX - 1][row]);
}
break;
case FocusLogic.PREVIOUS_PAGE_FIRST_ITEM:
newParent=getAppsCustomizePage(container,pageIndex - 1);
if (newParent != null) {
container.snapToPage(pageIndex - 1);
child=newParent.getChildAt(0);
}
break;
case FocusLogic.PREVIOUS_PAGE_LAST_ITEM:
newParent=getAppsCustomizePage(container,pageIndex - 1);
if (newParent != null) {
container.snapToPage(pageIndex - 1);
child=newParent.getChildAt(newParent.getChildCount() - 1);
}
break;
case FocusLogic.NEXT_PAGE_FIRST_ITEM:
newParent=getAppsCustomizePage(container,pageIndex + 1);
if (newParent != null) {
container.snapToPage(pageIndex + 1);
child=newParent.getChildAt(0);
}
break;
case FocusLogic.NEXT_PAGE_LEFT_COLUMN:
case FocusLogic.PREVIOUS_PAGE_LEFT_COLUMN:
newPageIndex=pageIndex + 1;
if (newIconIndex == FocusLogic.PREVIOUS_PAGE_LEFT_COLUMN) {
newPageIndex=pageIndex - 1;
}
newParent=getAppsCustomizePage(container,newPageIndex);
if (newParent != null) {
container.snapToPage(newPageIndex);
int row=FocusLogic.findRow(matrix,iconIndex);
child=newParent.getChildAt(matrix[0][row]);
}
break;
case FocusLogic.CURRENT_PAGE_FIRST_ITEM:
child=container.getChildAt(0);
break;
case FocusLogic.CURRENT_PAGE_LAST_ITEM:
child=itemContainer.getChildAt(itemContainer.getChildCount() - 1);
break;
default :
child=itemContainer.getChildAt(newIconIndex);
break;
}
if (child != null) {
child.requestFocus();
playSoundEffect(keyCode,v);
}
 else {
handleNoopKey(keyCode,v);
}
return consume;
}
