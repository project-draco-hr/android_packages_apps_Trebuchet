{
  ItemInfo item=(ItemInfo)d.dragInfo;
  boolean wasWaitingForUninstall=mWaitingForUninstall;
  mWaitingForUninstall=false;
  if (isAllAppsApplication(d.dragSource,item)) {
    uninstallApp(mLauncher,(AppInfo)item);
  }
 else   if (isUninstallFromWorkspace(d)) {
    ShortcutInfo shortcut=(ShortcutInfo)item;
    if (shortcut.intent != null && shortcut.intent.getComponent() != null) {
      final ComponentName componentName=shortcut.intent.getComponent();
      final DragSource dragSource=d.dragSource;
      final UserHandleCompat user=shortcut.user;
      mWaitingForUninstall=mLauncher.startApplicationUninstallActivity(componentName,shortcut.flags,user);
      if (mWaitingForUninstall) {
        final Runnable checkIfUninstallWasSuccess=new Runnable(){
          @Override public void run(){
            mWaitingForUninstall=false;
            String packageName=componentName.getPackageName();
            boolean uninstallSuccessful=!AllAppsList.packageHasActivities(getContext(),packageName,user);
            if (dragSource instanceof Folder) {
              ((Folder)dragSource).onUninstallActivityReturned(uninstallSuccessful);
            }
 else             if (dragSource instanceof Workspace) {
              ((Workspace)dragSource).onUninstallActivityReturned(uninstallSuccessful);
            }
          }
        }
;
        mLauncher.addOnResumeCallback(checkIfUninstallWasSuccess);
      }
    }
  }
 else   if (isDragSourceWorkspaceOrFolder(d)) {
    removeWorkspaceOrFolderItem(mLauncher,item,null);
  }
  if (wasWaitingForUninstall && !mWaitingForUninstall) {
    if (d.dragSource instanceof Folder) {
      ((Folder)d.dragSource).onUninstallActivityReturned(false);
    }
 else     if (d.dragSource instanceof Workspace) {
      ((Workspace)d.dragSource).onUninstallActivityReturned(false);
    }
  }
}
