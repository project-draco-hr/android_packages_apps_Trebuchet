{
  String packageName=a.getString(R.styleable.Favorite_packageName);
  String className=a.getString(R.styleable.Favorite_className);
  if (packageName == null || className == null) {
    return false;
  }
  boolean hasPackage=true;
  ComponentName cn=new ComponentName(packageName,className);
  try {
    packageManager.getReceiverInfo(cn,0);
  }
 catch (  Exception e) {
    String[] packages=packageManager.currentToCanonicalPackageNames(new String[]{packageName});
    cn=new ComponentName(packages[0],className);
    try {
      packageManager.getReceiverInfo(cn,0);
    }
 catch (    Exception e1) {
      hasPackage=false;
    }
  }
  if (hasPackage) {
    int spanX=a.getInt(R.styleable.Favorite_spanX,0);
    int spanY=a.getInt(R.styleable.Favorite_spanY,0);
    Bundle extras=new Bundle();
    int widgetDepth=parser.getDepth();
    while ((type=parser.next()) != XmlPullParser.END_TAG || parser.getDepth() > widgetDepth) {
      if (type != XmlPullParser.START_TAG) {
        continue;
      }
      TypedArray ar=mContext.obtainStyledAttributes(attrs,R.styleable.Extra);
      if (TAG_EXTRA.equals(parser.getName())) {
        String key=ar.getString(R.styleable.Extra_key);
        String value=ar.getString(R.styleable.Extra_value);
        if (key != null && value != null) {
          extras.putString(key,value);
        }
 else {
          throw new RuntimeException("Widget extras must have a key and value");
        }
      }
 else {
        throw new RuntimeException("Widgets can contain only extras");
      }
      ar.recycle();
    }
    return addAppWidget(db,values,cn,spanX,spanY,extras);
  }
  return false;
}
