{
  boolean allocatedAppWidgets=false;
  final AppWidgetManager appWidgetManager=AppWidgetManager.getInstance(mContext);
  try {
    int appWidgetId=mAppWidgetHost.allocateAppWidgetId();
    values.put(Favorites.ITEM_TYPE,Favorites.ITEM_TYPE_APPWIDGET);
    values.put(Favorites.APPWIDGET_ID,appWidgetId);
    values.put(Favorites.APPWIDGET_PROVIDER,cn.flattenToString());
    values.put(Favorites._ID,generateNewItemId());
    dbInsertAndCheck(this,db,TABLE_FAVORITES,null,values);
    allocatedAppWidgets=true;
    appWidgetManager.bindAppWidgetIdIfAllowed(appWidgetId,cn);
    if (extras != null && !extras.isEmpty()) {
      Intent intent=new Intent(ACTION_APPWIDGET_DEFAULT_WORKSPACE_CONFIGURE);
      intent.setComponent(cn);
      intent.putExtras(extras);
      intent.putExtra(AppWidgetManager.EXTRA_APPWIDGET_ID,appWidgetId);
      mContext.sendBroadcast(intent);
    }
  }
 catch (  RuntimeException ex) {
    Log.e(TAG,"Problem allocating appWidgetId",ex);
  }
  return allocatedAppWidgets;
}
