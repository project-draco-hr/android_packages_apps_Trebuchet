{
  final int iconResId=getAttributeResourceValue(parser,ATTR_ICON,0);
  final int titleResId=getAttributeResourceValue(parser,ATTR_TITLE,0);
  Intent intent;
  String uri=null;
  try {
    uri=getAttributeValue(parser,ATTR_URI);
    intent=Intent.parseUri(uri,0);
  }
 catch (  URISyntaxException e) {
    Log.w(TAG,"Shortcut has malformed uri: " + uri);
    return -1;
  }
  if (iconResId == 0 || titleResId == 0) {
    Log.w(TAG,"Shortcut is missing title or icon resource ID");
    return -1;
  }
  long id=generateNewItemId();
  intent.setFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
  values.put(Favorites.INTENT,intent.toUri(0));
  values.put(Favorites.TITLE,res.getString(titleResId));
  values.put(Favorites.ITEM_TYPE,Favorites.ITEM_TYPE_SHORTCUT);
  values.put(Favorites.SPANX,1);
  values.put(Favorites.SPANY,1);
  values.put(Favorites.ICON_TYPE,Favorites.ICON_TYPE_RESOURCE);
  values.put(Favorites.ICON_PACKAGE,res.getResourcePackageName(iconResId));
  values.put(Favorites.ICON_RESOURCE,res.getResourceName(iconResId));
  values.put(Favorites._ID,id);
  if (dbInsertAndCheck(this,db,TABLE_FAVORITES,null,values) < 0) {
    return -1;
  }
  return id;
}
