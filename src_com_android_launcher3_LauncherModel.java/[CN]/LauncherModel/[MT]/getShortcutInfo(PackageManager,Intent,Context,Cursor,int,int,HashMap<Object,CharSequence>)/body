{
  Bitmap icon=null;
  final ShortcutInfo info=new ShortcutInfo();
  ComponentName componentName=intent.getComponent();
  if (componentName == null) {
    return null;
  }
  try {
    PackageInfo pi=manager.getPackageInfo(componentName.getPackageName(),0);
    if (!pi.applicationInfo.enabled) {
      return null;
    }
  }
 catch (  NameNotFoundException e) {
    Log.d(TAG,"getPackInfo failed for package " + componentName.getPackageName());
  }
  ResolveInfo resolveInfo=null;
  ComponentName oldComponent=intent.getComponent();
  Intent newIntent=new Intent(intent.getAction(),null);
  newIntent.addCategory(Intent.CATEGORY_LAUNCHER);
  newIntent.setPackage(oldComponent.getPackageName());
  List<ResolveInfo> infos=manager.queryIntentActivities(newIntent,0);
  for (  ResolveInfo i : infos) {
    ComponentName cn=new ComponentName(i.activityInfo.packageName,i.activityInfo.name);
    if (cn.equals(oldComponent)) {
      resolveInfo=i;
    }
  }
  if (resolveInfo == null) {
    resolveInfo=manager.resolveActivity(intent,0);
  }
  if (resolveInfo != null) {
    icon=mIconCache.getIcon(componentName,resolveInfo,labelCache);
  }
  if (icon == null) {
    if (c != null) {
      icon=getIconFromCursor(c,iconIndex,context);
    }
  }
  if (icon == null) {
    icon=getFallbackIcon();
    info.usingFallbackIcon=true;
  }
  info.setIcon(icon);
  if (resolveInfo != null) {
    ComponentName key=LauncherModel.getComponentNameFromResolveInfo(resolveInfo);
    if (labelCache != null && labelCache.containsKey(key)) {
      info.title=labelCache.get(key);
    }
 else {
      info.title=resolveInfo.activityInfo.loadLabel(manager);
      if (labelCache != null) {
        labelCache.put(key,info.title);
      }
    }
  }
  if (info.title == null) {
    if (c != null) {
      info.title=c.getString(titleIndex);
    }
  }
  if (info.title == null) {
    info.title=componentName.getClassName();
  }
  info.itemType=LauncherSettings.Favorites.ITEM_TYPE_APPLICATION;
  return info;
}
