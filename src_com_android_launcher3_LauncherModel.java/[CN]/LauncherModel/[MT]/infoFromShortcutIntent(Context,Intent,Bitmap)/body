{
  Intent intent=data.getParcelableExtra(Intent.EXTRA_SHORTCUT_INTENT);
  String name=data.getStringExtra(Intent.EXTRA_SHORTCUT_NAME);
  Parcelable bitmap=data.getParcelableExtra(Intent.EXTRA_SHORTCUT_ICON);
  if (intent == null) {
    Log.e(TAG,"Can't construct ShorcutInfo with null intent");
    return null;
  }
  Bitmap icon=null;
  boolean customIcon=false;
  ShortcutIconResource iconResource=null;
  if (bitmap instanceof Bitmap) {
    icon=Utilities.createIconBitmap((Bitmap)bitmap,context);
    customIcon=true;
  }
 else {
    Parcelable extra=data.getParcelableExtra(Intent.EXTRA_SHORTCUT_ICON_RESOURCE);
    if (extra != null && extra instanceof ShortcutIconResource) {
      try {
        iconResource=(ShortcutIconResource)extra;
        final PackageManager packageManager=context.getPackageManager();
        Resources resources=packageManager.getResourcesForApplication(iconResource.packageName);
        final int id=resources.getIdentifier(iconResource.resourceName,null,null);
        icon=Utilities.createIconBitmap(mIconCache.getFullResIcon(resources,id),context);
      }
 catch (      Exception e) {
        Log.w(TAG,"Could not load shortcut icon: " + extra);
      }
    }
  }
  final ShortcutInfo info=new ShortcutInfo();
  info.user=UserHandleCompat.myUserHandle();
  if (icon == null) {
    if (fallbackIcon != null) {
      icon=fallbackIcon;
    }
 else {
      icon=mIconCache.getDefaultIcon(info.user);
      info.usingFallbackIcon=true;
    }
  }
  info.setIcon(icon);
  info.title=name;
  info.contentDescription=mUserManager.getBadgedLabelForUser(info.title.toString(),info.user);
  info.intent=intent;
  info.customIcon=customIcon;
  info.iconResource=iconResource;
  return info;
}
