{
  final ShortcutInfo info=new ShortcutInfo();
  info.user=UserHandleCompat.myUserHandle();
  mIconCache.getTitleAndIcon(info,intent,info.user,true);
  if ((promiseType & ShortcutInfo.FLAG_RESTORED_ICON) != 0) {
    String title=(cursor != null) ? cursor.getString(titleIndex) : null;
    if (!TextUtils.isEmpty(title)) {
      info.title=title;
    }
    info.status=ShortcutInfo.FLAG_RESTORED_ICON;
  }
 else   if ((promiseType & ShortcutInfo.FLAG_AUTOINTALL_ICON) != 0) {
    if (TextUtils.isEmpty(info.title)) {
      info.title=(cursor != null) ? cursor.getString(titleIndex) : "";
    }
    info.status=ShortcutInfo.FLAG_AUTOINTALL_ICON;
  }
 else {
    throw new InvalidParameterException("Invalid restoreType " + promiseType);
  }
  info.contentDescription=mUserManager.getBadgedLabelForUser(info.title.toString(),info.user);
  info.itemType=LauncherSettings.Favorites.ITEM_TYPE_SHORTCUT;
  info.promisedIntent=intent;
  return info;
}
