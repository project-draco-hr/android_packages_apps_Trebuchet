{
  if (user == null) {
    Log.d(TAG,"Null user found in getShortcutInfo");
    return null;
  }
  ComponentName componentName=intent.getComponent();
  if (componentName == null) {
    Log.d(TAG,"Missing component found in getShortcutInfo: " + componentName);
    return null;
  }
  Intent newIntent=new Intent(intent.getAction(),null);
  newIntent.addCategory(Intent.CATEGORY_LAUNCHER);
  newIntent.setComponent(componentName);
  LauncherActivityInfoCompat lai=mLauncherApps.resolveActivity(newIntent,user);
  if ((lai == null) && !allowMissingTarget) {
    Log.d(TAG,"Missing activity found in getShortcutInfo: " + componentName);
    return null;
  }
  final ShortcutInfo info=new ShortcutInfo();
  Bitmap icon=mIconCache.getIcon(componentName,lai,labelCache);
  if (icon == null) {
    if (c != null) {
      icon=getIconFromCursor(c,iconIndex,context);
    }
  }
  if (icon == null) {
    icon=mIconCache.getDefaultIcon(user);
    info.usingFallbackIcon=true;
  }
  info.setIcon(icon);
  if (labelCache != null) {
    info.title=labelCache.get(componentName);
  }
  if (info.title == null && lai != null) {
    info.title=lai.getLabel();
    if (labelCache != null) {
      labelCache.put(componentName,info.title);
    }
  }
  if (info.title == null) {
    if (c != null) {
      info.title=c.getString(titleIndex);
    }
  }
  if (info.title == null) {
    info.title=componentName.getClassName();
  }
  info.itemType=LauncherSettings.Favorites.ITEM_TYPE_APPLICATION;
  info.user=user;
  info.contentDescription=mUserManager.getBadgedLabelForUser(info.title.toString(),info.user);
  return info;
}
