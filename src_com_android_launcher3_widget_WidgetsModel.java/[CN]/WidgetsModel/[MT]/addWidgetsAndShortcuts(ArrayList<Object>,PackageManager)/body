{
  if (DEBUG) {
    Log.d(TAG,"addWidgetsAndShortcuts, widgetsShortcuts#=" + widgetsShortcuts.size());
  }
  HashMap<String,PackageItemInfo> tmpPackageItemInfos=new HashMap<>();
  mWidgetsList.clear();
  for (  Object o : widgetsShortcuts) {
    String packageName="";
    if (o instanceof LauncherAppWidgetProviderInfo) {
      LauncherAppWidgetProviderInfo widgetInfo=(LauncherAppWidgetProviderInfo)o;
      packageName=widgetInfo.provider.getPackageName();
    }
 else     if (o instanceof ResolveInfo) {
      ResolveInfo resolveInfo=(ResolveInfo)o;
      packageName=resolveInfo.activityInfo.packageName;
    }
 else {
      Log.e(TAG,String.format("addWidgetsAndShortcuts, nothing added for class=%s",o.getClass().toString()));
    }
    PackageItemInfo pInfo=tmpPackageItemInfos.get(packageName);
    ArrayList<Object> widgetsShortcutsList=mWidgetsList.get(pInfo);
    if (widgetsShortcutsList != null) {
      widgetsShortcutsList.add(o);
    }
 else {
      widgetsShortcutsList=new ArrayList<Object>();
      widgetsShortcutsList.add(o);
      pInfo=new PackageItemInfo(packageName);
      mIconCache.getTitleAndIconForApp(packageName,UserHandleCompat.myUserHandle(),true,pInfo);
      mWidgetsList.put(pInfo,widgetsShortcutsList);
      tmpPackageItemInfos.put(packageName,pInfo);
      mPackageItemInfos.add(pInfo);
    }
  }
  sortPackageItemInfos();
  for (  PackageItemInfo p : mPackageItemInfos) {
    Collections.sort(mWidgetsList.get(p),mWidgetAndShortcutNameComparator);
  }
  mAdapter.notifyDataSetChanged();
}
