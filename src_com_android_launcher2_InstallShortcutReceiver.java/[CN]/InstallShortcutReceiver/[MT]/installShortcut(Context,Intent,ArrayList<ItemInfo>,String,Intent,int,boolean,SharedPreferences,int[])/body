{
  if (findEmptyCell(context,items,mCoordinates,screen)) {
    if (intent != null) {
      if (intent.getAction() == null) {
        intent.setAction(Intent.ACTION_VIEW);
      }
 else       if (intent.getAction().equals(Intent.ACTION_MAIN) && intent.getCategories().contains(Intent.CATEGORY_LAUNCHER)) {
        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED);
      }
      boolean duplicate=data.getBooleanExtra(Launcher.EXTRA_SHORTCUT_DUPLICATE,true);
      if (duplicate || !shortcutExists) {
        int newAppsScreen=sharedPrefs.getInt(NEW_APPS_PAGE_KEY,screen);
        Set<String> newApps=new HashSet<String>();
        if (newAppsScreen == screen) {
          newApps=sharedPrefs.getStringSet(NEW_APPS_LIST_KEY,newApps);
        }
        newApps.add(intent.toUri(0).toString());
        final Set<String> savedNewApps=newApps;
        new Thread("setNewAppsThread"){
          public void run(){
            sharedPrefs.edit().putInt(NEW_APPS_PAGE_KEY,screen).putStringSet(NEW_APPS_LIST_KEY,savedNewApps).commit();
          }
        }
.start();
        LauncherApplication app=(LauncherApplication)context.getApplicationContext();
        ShortcutInfo info=app.getModel().addShortcut(context,data,LauncherSettings.Favorites.CONTAINER_DESKTOP,screen,mCoordinates[0],mCoordinates[1],true);
        if (info == null) {
          return false;
        }
      }
 else {
        result[0]=INSTALL_SHORTCUT_IS_DUPLICATE;
      }
      return true;
    }
  }
 else {
    result[0]=INSTALL_SHORTCUT_NO_SPACE;
  }
  return false;
}
