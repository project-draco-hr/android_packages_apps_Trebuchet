{
  final ArrayList<View> views=getCellLayoutChildrenSortedSpatially(layout,parent);
  final CellLayout.LayoutParams lp=(CellLayout.LayoutParams)v.getLayoutParams();
  final int cellCountX=layout.getCountX();
  final int cellCountY=layout.getCountY();
  final int row=lp.cellY;
  final int newRow=row + lineDelta;
  if (0 <= newRow && newRow < cellCountY) {
    float closestDistance=Float.MAX_VALUE;
    int closestIndex=-1;
    int index=views.indexOf(v);
    int endIndex=(lineDelta < 0) ? -1 : views.size();
    while (index != endIndex) {
      View newV=views.get(index);
      CellLayout.LayoutParams tmpLp=(CellLayout.LayoutParams)newV.getLayoutParams();
      boolean satisfiesRow=(lineDelta < 0) ? (tmpLp.cellY < row) : (tmpLp.cellY > row);
      if (satisfiesRow && newV instanceof BubbleTextView) {
        float tmpDistance=(float)Math.sqrt(Math.pow(tmpLp.cellX - lp.cellX,2) + Math.pow(tmpLp.cellY - lp.cellY,2));
        if (tmpDistance < closestDistance) {
          closestIndex=index;
          closestDistance=tmpDistance;
        }
      }
      if (index <= endIndex) {
        ++index;
      }
 else {
        --index;
      }
    }
    if (closestIndex > -1) {
      return views.get(closestIndex);
    }
  }
  return null;
}
