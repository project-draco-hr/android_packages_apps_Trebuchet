{
  int version=oldVersion;
  if (version == 1) {
    db.beginTransaction();
    try {
      db.execSQL("ALTER TABLE favorites " + "ADD COLUMN gadgetId INTEGER NOT NULL DEFAULT -1;");
      db.setTransactionSuccessful();
      version=2;
    }
 catch (    SQLException ex) {
      Log.e(LOG_TAG,ex.getMessage(),ex);
    }
 finally {
      db.endTransaction();
    }
  }
  if (version != DATABASE_VERSION) {
    Log.w(LOG_TAG,"Destroying all old data.");
    db.execSQL("DROP TABLE IF EXISTS " + TABLE_FAVORITES);
    onCreate(db);
  }
}
