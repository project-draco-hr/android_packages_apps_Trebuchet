{
  if (mState != State.WORKSPACE || mWorkspace.getState() != Workspace.State.NORMAL) {
    boolean wasInSpringLoadedMode=(mState != State.WORKSPACE);
    mWorkspace.setVisibility(View.VISIBLE);
    mStateTransitionAnimation.startAnimationToWorkspace(mState,Workspace.State.NORMAL,animated,onCompleteRunnable);
    if (mSearchDropTargetBar != null) {
      mSearchDropTargetBar.showSearchBar(animated && wasInSpringLoadedMode);
    }
    if (mAllAppsButton != null) {
      mAllAppsButton.requestFocus();
    }
  }
  mState=State.WORKSPACE;
  mUserPresent=true;
  updateAutoAdvanceState();
  getWindow().getDecorView().sendAccessibilityEvent(AccessibilityEvent.TYPE_WINDOW_STATE_CHANGED);
  onWorkspaceShown(animated);
}
