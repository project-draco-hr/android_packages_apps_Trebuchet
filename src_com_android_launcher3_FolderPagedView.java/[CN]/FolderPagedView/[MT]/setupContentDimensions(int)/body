{
  mAllocatedContentSize=count;
  boolean done;
  if (count >= mMaxItemsPerPage) {
    mGridCountX=mMaxCountX;
    mGridCountY=mMaxCountY;
    done=true;
  }
 else {
    done=false;
  }
  while (!done) {
    int oldCountX=mGridCountX;
    int oldCountY=mGridCountY;
    if (mGridCountX * mGridCountY < count) {
      if ((mGridCountX <= mGridCountY || mGridCountY == mMaxCountY) && mGridCountX < mMaxCountX) {
        mGridCountX++;
      }
 else       if (mGridCountY < mMaxCountY) {
        mGridCountY++;
      }
      if (mGridCountY == 0)       mGridCountY++;
    }
 else     if ((mGridCountY - 1) * mGridCountX >= count && mGridCountY >= mGridCountX) {
      mGridCountY=Math.max(0,mGridCountY - 1);
    }
 else     if ((mGridCountX - 1) * mGridCountY >= count) {
      mGridCountX=Math.max(0,mGridCountX - 1);
    }
    done=mGridCountX == oldCountX && mGridCountY == oldCountY;
  }
  for (int i=getPageCount() - 1; i >= 0; i--) {
    getPageAt(i).setGridSize(mGridCountX,mGridCountY);
  }
}
