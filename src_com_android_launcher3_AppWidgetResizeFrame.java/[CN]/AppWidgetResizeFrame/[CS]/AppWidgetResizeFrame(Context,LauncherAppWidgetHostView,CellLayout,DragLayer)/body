{
  super(context);
  mLauncher=(Launcher)context;
  mCellLayout=cellLayout;
  mWidgetView=widgetView;
  LauncherAppWidgetProviderInfo info=(LauncherAppWidgetProviderInfo)widgetView.getAppWidgetInfo();
  mResizeMode=info.resizeMode;
  mDragLayer=dragLayer;
  mMinHSpan=info.minSpanX;
  mMinVSpan=info.minSpanY;
  setBackgroundResource(R.drawable.widget_resize_frame_holo);
  setPadding(0,0,0,0);
  LayoutParams lp;
  mLeftHandle=new ImageView(context);
  mLeftHandle.setImageResource(R.drawable.widget_resize_handle_left);
  lp=new LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT,Gravity.LEFT | Gravity.CENTER_VERTICAL);
  addView(mLeftHandle,lp);
  mRightHandle=new ImageView(context);
  mRightHandle.setImageResource(R.drawable.widget_resize_handle_right);
  lp=new LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT,Gravity.RIGHT | Gravity.CENTER_VERTICAL);
  addView(mRightHandle,lp);
  mTopHandle=new ImageView(context);
  mTopHandle.setImageResource(R.drawable.widget_resize_handle_top);
  lp=new LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT,Gravity.CENTER_HORIZONTAL | Gravity.TOP);
  addView(mTopHandle,lp);
  mBottomHandle=new ImageView(context);
  mBottomHandle.setImageResource(R.drawable.widget_resize_handle_bottom);
  lp=new LayoutParams(LayoutParams.WRAP_CONTENT,LayoutParams.WRAP_CONTENT,Gravity.CENTER_HORIZONTAL | Gravity.BOTTOM);
  addView(mBottomHandle,lp);
  Rect p=new Rect(0,0,0,0);
  if (!info.isCustomWidget) {
    p=AppWidgetHostView.getDefaultPaddingForWidget(context,widgetView.getAppWidgetInfo().provider,null);
  }
 else {
    Resources r=context.getResources();
    int padding=r.getDimensionPixelSize(R.dimen.default_widget_padding);
    p.set(padding,padding,padding,padding);
  }
  mWidgetPaddingLeft=p.left;
  mWidgetPaddingTop=p.top;
  mWidgetPaddingRight=p.right;
  mWidgetPaddingBottom=p.bottom;
  if (mResizeMode == AppWidgetProviderInfo.RESIZE_HORIZONTAL) {
    mTopHandle.setVisibility(GONE);
    mBottomHandle.setVisibility(GONE);
  }
 else   if (mResizeMode == AppWidgetProviderInfo.RESIZE_VERTICAL) {
    mLeftHandle.setVisibility(GONE);
    mRightHandle.setVisibility(GONE);
  }
  final float density=mLauncher.getResources().getDisplayMetrics().density;
  mBackgroundPadding=(int)Math.ceil(density * BACKGROUND_PADDING);
  mTouchTargetWidth=2 * mBackgroundPadding;
  mCellLayout.markCellsAsUnoccupiedForView(mWidgetView);
}
