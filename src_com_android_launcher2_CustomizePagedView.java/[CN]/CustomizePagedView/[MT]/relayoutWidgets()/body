{
  if (mWidgetList.isEmpty())   return 0;
  ArrayList<AppWidgetProviderInfo> newPage=new ArrayList<AppWidgetProviderInfo>();
  mWidgetPages.clear();
  mWidgetPages.add(newPage);
  final int maxNumCellsPerRow=mMaxWidgetsCellHSpan;
  final int widgetCount=mWidgetList.size();
  int numCellsInRow=0;
  for (int i=0; i < widgetCount; ++i) {
    final AppWidgetProviderInfo info=mWidgetList.get(i);
    int cellSpanX=Math.max(sMinWidgetCellHSpan,Math.min(sMaxWidgetCellHSpan,mWorkspaceWidgetLayout.estimateCellHSpan(info.minWidth)));
    if ((numCellsInRow + cellSpanX) > maxNumCellsPerRow) {
      numCellsInRow=0;
      newPage=new ArrayList<AppWidgetProviderInfo>();
      mWidgetPages.add(newPage);
    }
    newPage.add(info);
    numCellsInRow+=cellSpanX;
  }
  return mWidgetPages.size();
}
