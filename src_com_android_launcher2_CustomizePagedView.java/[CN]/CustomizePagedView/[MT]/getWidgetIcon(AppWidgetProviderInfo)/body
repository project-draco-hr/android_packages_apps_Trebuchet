{
  PackageManager packageManager=mLauncher.getPackageManager();
  String packageName=info.provider.getPackageName();
  Drawable drawable=null;
  if (info.previewImage != 0) {
    drawable=packageManager.getDrawable(packageName,info.previewImage,null);
    if (drawable == null) {
      Log.w(TAG,"Can't load icon drawable 0x" + Integer.toHexString(info.icon) + " for provider: "+ info.provider);
    }
 else {
      return drawable;
    }
  }
  if (drawable == null) {
    Resources resources=mLauncher.getResources();
    final int minDim=mWorkspaceWidgetLayout.estimateCellWidth(1);
    final int maxDim=mWorkspaceWidgetLayout.estimateCellWidth(3);
    int width=(int)(Math.max(minDim,Math.min(maxDim,info.minWidth)) * sScaleFactor);
    int height=(int)(Math.max(minDim,Math.min(maxDim,info.minHeight)) * sScaleFactor);
    Bitmap bitmap=Bitmap.createBitmap(width,height,Config.ARGB_8888);
    mCanvas.setBitmap(bitmap);
    mCanvas.clipRect(0,0,width,height,Op.REPLACE);
    Drawable background=resources.getDrawable(R.drawable.default_widget_preview);
    background.setBounds(0,0,width,height);
    background.draw(mCanvas);
    try {
      Rect tmpRect=new Rect();
      Drawable icon=null;
      if (info.icon > 0) {
        icon=packageManager.getDrawable(packageName,info.icon,null);
      }
 else {
        icon=resources.getDrawable(R.drawable.ic_launcher_application);
      }
      background.getPadding(tmpRect);
      final int iconSize=minDim / 2;
      final int offset=iconSize / 4;
      icon.setBounds(new Rect(offset,offset,offset + iconSize,offset + iconSize));
      icon.draw(mCanvas);
    }
 catch (    Resources.NotFoundException e) {
    }
    drawable=new FastBitmapDrawable(bitmap);
  }
  drawable.setBounds(0,0,drawable.getIntrinsicWidth(),drawable.getIntrinsicHeight());
  return drawable;
}
