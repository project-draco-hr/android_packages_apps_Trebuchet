{
  final int minDim=mWorkspaceWidgetLayout.estimateCellWidth(1);
  final int dim=mWorkspaceWidgetLayout.estimateCellWidth(mWallpaperCellHSpan);
  Resources resources=mLauncher.getResources();
  int width=(int)(dim * sScaleFactor);
  int height=(int)(dim * sScaleFactor);
  final Bitmap bitmap=Bitmap.createBitmap(width,height,Config.ARGB_8888);
  Drawable background=parseWallpaperPreviewXml(new ComponentName(info.activityInfo.packageName,info.activityInfo.name),info);
  boolean foundCustomDrawable=background != null;
  if (!foundCustomDrawable) {
    background=resources.getDrawable(R.drawable.default_widget_preview);
  }
  renderDrawableToBitmap(background,bitmap,0,0,width,height,1.0f,1.0f);
  if (!foundCustomDrawable) {
    try {
      final IconCache iconCache=((LauncherApplication)mLauncher.getApplication()).getIconCache();
      Drawable icon=new FastBitmapDrawable(Utilities.createIconBitmap(iconCache.getFullResIcon(info,mPackageManager),mContext));
      final int iconSize=minDim / 2;
      final int offset=iconSize / 4;
      renderDrawableToBitmap(icon,null,offset,offset,iconSize,iconSize,1.0f,1.0f);
    }
 catch (    Resources.NotFoundException e) {
    }
  }
  FastBitmapDrawable drawable=new FastBitmapDrawable(bitmap);
  drawable.setBounds(0,0,drawable.getIntrinsicWidth(),drawable.getIntrinsicHeight());
  return drawable;
}
