{
  final int cellHeight=layout.getCellHeight();
  final int screenHeight=mLauncher.getResources().getDisplayMetrics().heightPixels;
  availableHeight-=mPageLayoutPaddingTop + mPageLayoutPaddingBottom;
  availableHeight-=cellHeight;
  Resources r=getContext().getResources();
  float scaleFactor=r.getInteger(R.integer.config_allAppsZoomScaleFactor) / 100f;
  availableHeight-=screenHeight * scaleFactor;
  if (availableHeight > 0) {
    return Math.min(mMaxCellCountY,1 + availableHeight / (cellHeight + mPageLayoutHeightGap));
  }
  return 0;
}
