{
  super.onPrepareOptionsMenu(menu);
  if (mAllAppsGrid.isAnimating()) {
    return false;
  }
  boolean visible=!mAllAppsGrid.isVisible();
  menu.setGroupVisible(MENU_GROUP_ADD,visible);
  menu.setGroupVisible(MENU_GROUP_WALLPAPER,visible);
  if (visible) {
    mMenuAddInfo=mWorkspace.updateOccupiedCellsForCurrentScreen(null);
    menu.setGroupEnabled(MENU_GROUP_ADD,mMenuAddInfo != null && mMenuAddInfo.valid);
  }
  return true;
}
