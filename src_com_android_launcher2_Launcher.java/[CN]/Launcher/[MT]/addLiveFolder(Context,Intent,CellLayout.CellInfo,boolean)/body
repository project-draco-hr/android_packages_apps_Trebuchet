{
  Intent baseIntent=data.getParcelableExtra(LiveFolders.EXTRA_LIVE_FOLDER_BASE_INTENT);
  String name=data.getStringExtra(LiveFolders.EXTRA_LIVE_FOLDER_NAME);
  Drawable icon=null;
  Intent.ShortcutIconResource iconResource=null;
  Parcelable extra=data.getParcelableExtra(LiveFolders.EXTRA_LIVE_FOLDER_ICON);
  if (extra != null && extra instanceof Intent.ShortcutIconResource) {
    try {
      iconResource=(Intent.ShortcutIconResource)extra;
      final PackageManager packageManager=context.getPackageManager();
      Resources resources=packageManager.getResourcesForApplication(iconResource.packageName);
      final int id=resources.getIdentifier(iconResource.resourceName,null,null);
      icon=resources.getDrawable(id);
    }
 catch (    Exception e) {
      Log.w(TAG,"Could not load live folder icon: " + extra);
    }
  }
  if (icon == null) {
    icon=context.getResources().getDrawable(R.drawable.ic_launcher_folder);
  }
  final LiveFolderInfo info=new LiveFolderInfo();
  info.icon=Utilities.createIconBitmap(icon,context);
  info.title=name;
  info.iconResource=iconResource;
  info.uri=data.getData();
  info.baseIntent=baseIntent;
  info.displayMode=data.getIntExtra(LiveFolders.EXTRA_LIVE_FOLDER_DISPLAY_MODE,LiveFolders.DISPLAY_MODE_GRID);
  LauncherModel.addItemToDatabase(context,info,LauncherSettings.Favorites.CONTAINER_DESKTOP,cellInfo.screen,cellInfo.cellX,cellInfo.cellY,notify);
  mFolders.put(info.id,info);
  return info;
}
