{
  super.onNewIntent(intent);
  if (Intent.ACTION_MAIN.equals(intent.getAction())) {
    closeSystemDialogs();
    boolean alreadyOnHome=((intent.getFlags() & Intent.FLAG_ACTIVITY_BROUGHT_TO_FRONT) != Intent.FLAG_ACTIVITY_BROUGHT_TO_FRONT);
    boolean allAppsVisible=isAllAppsVisible();
    boolean customizationDrawerVisible=isCustomizationDrawerVisible();
    if (LauncherApplication.isScreenXLarge()) {
      if (alreadyOnHome && !mWorkspace.isSmall() && !allAppsVisible&& !customizationDrawerVisible) {
        mWorkspace.shrinkToMiddle();
      }
 else {
        mWorkspace.unshrink(alreadyOnHome);
      }
    }
 else     if (!mWorkspace.isDefaultScreenShowing()) {
      mWorkspace.moveToDefaultScreen(alreadyOnHome && !allAppsVisible);
    }
    closeAllApps(alreadyOnHome && allAppsVisible);
    hideCustomizationDrawer(alreadyOnHome);
    final View v=getWindow().peekDecorView();
    if (v != null && v.getWindowToken() != null) {
      InputMethodManager imm=(InputMethodManager)getSystemService(INPUT_METHOD_SERVICE);
      imm.hideSoftInputFromWindow(v.getWindowToken(),0);
    }
  }
}
