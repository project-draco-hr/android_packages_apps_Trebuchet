{
  if (DEBUG_STRICT_MODE) {
    StrictMode.setThreadPolicy(new StrictMode.ThreadPolicy.Builder().detectDiskReads().detectDiskWrites().detectNetwork().penaltyLog().build());
    StrictMode.setVmPolicy(new StrictMode.VmPolicy.Builder().detectLeakedSqlLiteObjects().detectLeakedClosableObjects().penaltyLog().penaltyDeath().build());
  }
  super.onCreate(savedInstanceState);
  LauncherApplication app=((LauncherApplication)getApplication());
  mSharedPrefs=getSharedPreferences(LauncherApplication.getSharedPreferencesKey(),Context.MODE_PRIVATE);
  mModel=app.setLauncher(this);
  mIconCache=app.getIconCache();
  mDragController=new DragController(this);
  mInflater=getLayoutInflater();
  mAppWidgetManager=AppWidgetManager.getInstance(this);
  mAppWidgetHost=new LauncherAppWidgetHost(this,APPWIDGET_HOST_ID);
  mAppWidgetHost.startListening();
  if (PROFILE_STARTUP) {
    android.os.Debug.startMethodTracing(Environment.getExternalStorageDirectory() + "/launcher");
  }
  checkForLocaleChange();
  setContentView(R.layout.launcher);
  setupViews();
  showFirstRunWorkspaceCling();
  registerContentObservers();
  lockAllApps();
  mSavedState=savedInstanceState;
  restoreState(mSavedState);
  if (mAppsCustomizeContent != null) {
    mAppsCustomizeContent.onPackagesUpdated();
  }
  if (PROFILE_STARTUP) {
    android.os.Debug.stopMethodTracing();
  }
  if (!mRestoring) {
    mModel.startLoader(true);
  }
  if (!mModel.isAllAppsLoaded()) {
    ViewGroup appsCustomizeContentParent=(ViewGroup)mAppsCustomizeContent.getParent();
    mInflater.inflate(R.layout.apps_customize_progressbar,appsCustomizeContentParent);
  }
  mDefaultKeySsb=new SpannableStringBuilder();
  Selection.setSelection(mDefaultKeySsb,0);
  IntentFilter filter=new IntentFilter(Intent.ACTION_CLOSE_SYSTEM_DIALOGS);
  registerReceiver(mCloseSystemDialogsReceiver,filter);
  boolean searchVisible=false;
  boolean voiceVisible=false;
  int coi=getCurrentOrientationIndexForGlobalIcons();
  if (sGlobalSearchIcon[coi] == null || sVoiceSearchIcon[coi] == null || sAppMarketIcon[coi] == null) {
    updateAppMarketIcon();
    searchVisible=updateGlobalSearchIcon();
    voiceVisible=updateVoiceSearchIcon(searchVisible);
  }
  if (sGlobalSearchIcon[coi] != null) {
    updateGlobalSearchIcon(sGlobalSearchIcon[coi]);
    searchVisible=true;
  }
  if (sVoiceSearchIcon[coi] != null) {
    updateVoiceSearchIcon(sVoiceSearchIcon[coi]);
    voiceVisible=true;
  }
  if (sAppMarketIcon[coi] != null) {
    updateAppMarketIcon(sAppMarketIcon[coi]);
  }
  mSearchDropTargetBar.onSearchPackagesChanged(searchVisible,voiceVisible);
  final String forceEnableRotation=SystemProperties.get(FORCE_ENABLE_ROTATION_PROPERTY,"false");
  boolean enableRotation=getResources().getBoolean(R.bool.allow_rotation);
  if (enableRotation || "true".equalsIgnoreCase(forceEnableRotation)) {
    setRequestedOrientation(ActivityInfo.SCREEN_ORIENTATION_UNSPECIFIED);
  }
}
