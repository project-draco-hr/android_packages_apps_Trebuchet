{
  SectionInfo lastSectionInfo=null;
  String lastSectionName=null;
  FastScrollSectionInfo lastFastScrollerSectionInfo=null;
  int position=0;
  int appIndex=0;
  mFilteredApps.clear();
  mFastScrollerSections.clear();
  mAdapterItems.clear();
  mSections.clear();
  if (DEBUG_PREDICTIONS) {
    if (mPredictedAppComponents.isEmpty() && !mApps.isEmpty()) {
      mPredictedAppComponents.add(new ComponentKey(mApps.get(0).componentName,UserHandleCompat.myUserHandle()));
      mPredictedAppComponents.add(new ComponentKey(mApps.get(0).componentName,UserHandleCompat.myUserHandle()));
      mPredictedAppComponents.add(new ComponentKey(mApps.get(0).componentName,UserHandleCompat.myUserHandle()));
      mPredictedAppComponents.add(new ComponentKey(mApps.get(0).componentName,UserHandleCompat.myUserHandle()));
    }
  }
  mPredictedApps.clear();
  if (mPredictedAppComponents != null && !mPredictedAppComponents.isEmpty() && !hasFilter()) {
    for (    ComponentKey ck : mPredictedAppComponents) {
      AppInfo info=mComponentToAppMap.get(ck);
      if (info != null) {
        mPredictedApps.add(info);
      }
 else {
        if (LauncherAppState.isDogfoodBuild()) {
          Log.e(TAG,"Predicted app not found: " + ck.flattenToString(mLauncher));
        }
      }
      if (mPredictedApps.size() == mNumPredictedAppsPerRow) {
        break;
      }
    }
    if (!mPredictedApps.isEmpty()) {
      AdapterItem sectionItem=AdapterItem.asPredictionBarSpacer(position++);
      mAdapterItems.add(sectionItem);
    }
  }
  List<AppInfo> apps=getFiltersAppInfos();
  int numApps=apps.size();
  for (int i=0; i < numApps; i++) {
    AppInfo info=apps.get(i);
    String sectionName=getAndUpdateCachedSectionName(info.title);
    if (lastSectionInfo == null || !sectionName.equals(lastSectionName)) {
      lastSectionName=sectionName;
      lastSectionInfo=new SectionInfo();
      lastFastScrollerSectionInfo=new FastScrollSectionInfo(sectionName,(float)appIndex / numApps);
      mSections.add(lastSectionInfo);
      mFastScrollerSections.add(lastFastScrollerSectionInfo);
      if (!hasFilter()) {
        AdapterItem sectionItem=AdapterItem.asSectionBreak(position++,lastSectionInfo);
        mAdapterItems.add(sectionItem);
      }
    }
    AdapterItem appItem=AdapterItem.asApp(position++,lastSectionInfo,sectionName,lastSectionInfo.numApps++,info,appIndex++);
    if (lastSectionInfo.firstAppItem == null) {
      lastSectionInfo.firstAppItem=appItem;
      lastFastScrollerSectionInfo.appItem=appItem;
    }
    mAdapterItems.add(appItem);
    mFilteredApps.add(info);
  }
  mergeSections();
  if (mAdapter != null) {
    mAdapter.notifyDataSetChanged();
  }
  if (mAdapterChangedCallback != null) {
    mAdapterChangedCallback.onAdapterItemsChanged();
  }
}
