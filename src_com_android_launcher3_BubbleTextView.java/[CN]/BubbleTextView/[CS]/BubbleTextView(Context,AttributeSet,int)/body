{
  super(context,attrs,defStyle);
  LauncherAppState app=LauncherAppState.getInstance();
  DeviceProfile grid=app.getDynamicGrid().getDeviceProfile();
  TypedArray a=context.obtainStyledAttributes(attrs,R.styleable.BubbleTextView,defStyle,0);
  mCustomShadowsEnabled=a.getBoolean(R.styleable.BubbleTextView_customShadows,true);
  mLayoutHorizontal=a.getBoolean(R.styleable.BubbleTextView_layoutHorizontal,false);
  mIconSize=a.getDimensionPixelSize(R.styleable.BubbleTextView_iconSizeOverride,grid.allAppsIconSizePx);
  mIconPaddingSize=a.getDimensionPixelSize(R.styleable.BubbleTextView_iconPaddingOverride,grid.iconDrawablePaddingPx);
  mTextSize=a.getDimensionPixelSize(R.styleable.BubbleTextView_textSizeOverride,grid.allAppsIconTextSizePx);
  mDeferShadowGenerationOnTouch=a.getBoolean(R.styleable.BubbleTextView_deferShadowGeneration,false);
  a.recycle();
  if (mCustomShadowsEnabled) {
    mBackground=getBackground();
    setBackground(null);
  }
 else {
    mBackground=null;
  }
  if (mLayoutHorizontal) {
    setGravity(Gravity.CENTER_VERTICAL);
  }
  mLongPressHelper=new CheckLongPressHelper(this);
  mOutlineHelper=HolographicOutlineHelper.obtain(getContext());
  if (mCustomShadowsEnabled) {
    setShadowLayer(SHADOW_LARGE_RADIUS,0.0f,SHADOW_Y_OFFSET,SHADOW_LARGE_COLOUR);
  }
  setAccessibilityDelegate(LauncherAppState.getInstance().getAccessibilityDelegate());
}
