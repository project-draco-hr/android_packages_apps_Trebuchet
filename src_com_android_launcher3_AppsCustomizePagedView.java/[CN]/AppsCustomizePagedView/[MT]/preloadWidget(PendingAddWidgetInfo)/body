{
  final LauncherAppWidgetProviderInfo pInfo=info.info;
  final Bundle options=pInfo.isCustomWidget ? null : getDefaultOptionsForWidget(mLauncher,info);
  if (pInfo.configure != null) {
    info.bindOptions=options;
    return;
  }
  mWidgetCleanupState=WIDGET_PRELOAD_PENDING;
  mBindWidgetRunnable=new Runnable(){
    @Override public void run(){
      if (pInfo.isCustomWidget) {
        mWidgetCleanupState=WIDGET_BOUND;
        return;
      }
      mWidgetLoadingId=mLauncher.getAppWidgetHost().allocateAppWidgetId();
      if (AppWidgetManagerCompat.getInstance(mLauncher).bindAppWidgetIdIfAllowed(mWidgetLoadingId,pInfo,options)) {
        mWidgetCleanupState=WIDGET_BOUND;
      }
    }
  }
;
  post(mBindWidgetRunnable);
  mInflateWidgetRunnable=new Runnable(){
    @Override public void run(){
      if (mWidgetCleanupState != WIDGET_BOUND) {
        return;
      }
      AppWidgetHostView hostView=mLauncher.getAppWidgetHost().createView(getContext(),mWidgetLoadingId,pInfo);
      info.boundWidget=hostView;
      mWidgetCleanupState=WIDGET_INFLATED;
      hostView.setVisibility(INVISIBLE);
      int[] unScaledSize=mLauncher.getWorkspace().estimateItemSize(info,false);
      DragLayer.LayoutParams lp=new DragLayer.LayoutParams(unScaledSize[0],unScaledSize[1]);
      lp.x=lp.y=0;
      lp.customPosition=true;
      hostView.setLayoutParams(lp);
      mLauncher.getDragLayer().addView(hostView);
    }
  }
;
  post(mInflateWidgetRunnable);
}
