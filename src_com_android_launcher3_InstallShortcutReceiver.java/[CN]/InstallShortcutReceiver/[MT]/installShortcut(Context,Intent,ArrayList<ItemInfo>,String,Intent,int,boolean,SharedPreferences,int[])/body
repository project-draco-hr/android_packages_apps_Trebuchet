{
  int[] tmpCoordinates=new int[2];
  if (findEmptyCell(context,items,tmpCoordinates,screen)) {
    if (intent != null) {
      if (intent.getAction() == null) {
        intent.setAction(Intent.ACTION_VIEW);
      }
 else       if (intent.getAction().equals(Intent.ACTION_MAIN) && intent.getCategories() != null && intent.getCategories().contains(Intent.CATEGORY_LAUNCHER)) {
        intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK | Intent.FLAG_ACTIVITY_RESET_TASK_IF_NEEDED);
      }
      boolean duplicate=data.getBooleanExtra(Launcher.EXTRA_SHORTCUT_DUPLICATE,true);
      if (duplicate || !shortcutExists) {
        new Thread("setNewAppsThread"){
          public void run(){
synchronized (sLock) {
              final int newAppsScreen=sharedPrefs.getInt(NEW_APPS_PAGE_KEY,screen);
              SharedPreferences.Editor editor=sharedPrefs.edit();
              if (newAppsScreen == -1 || newAppsScreen == screen) {
                addToStringSet(sharedPrefs,editor,NEW_APPS_LIST_KEY,intent.toUri(0));
              }
              editor.putInt(NEW_APPS_PAGE_KEY,screen);
              editor.commit();
            }
          }
        }
.start();
        LauncherAppState app=LauncherAppState.getInstance();
        ShortcutInfo info=app.getModel().addShortcut(context,data,LauncherSettings.Favorites.CONTAINER_DESKTOP,screen,tmpCoordinates[0],tmpCoordinates[1],true);
        if (info == null) {
          return false;
        }
      }
 else {
        result[0]=INSTALL_SHORTCUT_IS_DUPLICATE;
      }
      return true;
    }
  }
 else {
    result[0]=INSTALL_SHORTCUT_NO_SPACE;
  }
  return false;
}
