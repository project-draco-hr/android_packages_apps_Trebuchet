{
  DisplayMetrics dm=res.getDisplayMetrics();
  ArrayList<DeviceProfileQuery> points=new ArrayList<DeviceProfileQuery>();
  transposeLayoutWithOrientation=res.getBoolean(R.bool.hotseat_transpose_layout_with_orientation);
  minWidthDps=minWidth;
  minHeightDps=minHeight;
  ComponentName cn=new ComponentName(context.getPackageName(),this.getClass().getName());
  defaultWidgetPadding=AppWidgetHostView.getDefaultPaddingForWidget(context,cn,null);
  edgeMarginPx=res.getDimensionPixelSize(R.dimen.dynamic_grid_edge_margin);
  desiredWorkspaceLeftRightMarginPx=2 * edgeMarginPx;
  pageIndicatorHeightPx=res.getDimensionPixelSize(R.dimen.dynamic_grid_page_indicator_height);
  defaultPageSpacingPx=res.getDimensionPixelSize(R.dimen.dynamic_grid_workspace_page_spacing);
  allAppsCellPaddingPx=res.getDimensionPixelSize(R.dimen.dynamic_grid_all_apps_cell_padding);
  overviewModeMinIconZoneHeightPx=res.getDimensionPixelSize(R.dimen.dynamic_grid_overview_min_icon_zone_height);
  overviewModeMaxIconZoneHeightPx=res.getDimensionPixelSize(R.dimen.dynamic_grid_overview_max_icon_zone_height);
  overviewModeBarItemWidthPx=res.getDimensionPixelSize(R.dimen.dynamic_grid_overview_bar_item_width);
  overviewModeBarSpacerWidthPx=res.getDimensionPixelSize(R.dimen.dynamic_grid_overview_bar_spacer_width);
  overviewModeIconZoneRatio=res.getInteger(R.integer.config_dynamic_grid_overview_icon_zone_percentage) / 100f;
  overviewModeScaleFactor=res.getInteger(R.integer.config_dynamic_grid_overview_scale_percentage) / 100f;
  for (  DeviceProfile p : profiles) {
    points.add(new DeviceProfileQuery(p,0f));
  }
  DeviceProfile closestProfile=findClosestDeviceProfile(minWidth,minHeight,points);
  numRows=closestProfile.numRows;
  numColumns=closestProfile.numColumns;
  numHotseatIcons=closestProfile.numHotseatIcons;
  hotseatAllAppsRank=(int)(numHotseatIcons / 2);
  defaultLayoutId=closestProfile.defaultLayoutId;
  defaultNoAllAppsLayoutId=closestProfile.defaultNoAllAppsLayoutId;
  points.clear();
  for (  DeviceProfile p : profiles) {
    points.add(new DeviceProfileQuery(p,p.iconSize));
  }
  iconSize=invDistWeightedInterpolate(minWidth,minHeight,points);
  allAppsIconSizePx=DynamicGrid.pxFromDp(iconSize,dm);
  points.clear();
  for (  DeviceProfile p : profiles) {
    points.add(new DeviceProfileQuery(p,p.iconTextSize));
  }
  iconTextSize=invDistWeightedInterpolate(minWidth,minHeight,points);
  iconDrawablePaddingOriginalPx=res.getDimensionPixelSize(R.dimen.dynamic_grid_icon_drawable_padding);
  allAppsIconTextSizePx=DynamicGrid.pxFromDp(iconTextSize,dm);
  points.clear();
  for (  DeviceProfile p : profiles) {
    points.add(new DeviceProfileQuery(p,p.hotseatIconSize));
  }
  hotseatIconSize=invDistWeightedInterpolate(minWidth,minHeight,points);
  updateFromConfiguration(context,res,wPx,hPx,awPx,ahPx);
  updateAvailableDimensions(context);
  computeAllAppsButtonSize(context);
}
