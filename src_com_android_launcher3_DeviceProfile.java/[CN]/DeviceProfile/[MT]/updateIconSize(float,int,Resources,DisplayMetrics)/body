{
  iconSizePx=(int)(DynamicGrid.pxFromDp(iconSize,dm) * scale);
  iconTextSizePx=(int)(DynamicGrid.pxFromSp(iconTextSize,dm) * scale);
  iconDrawablePaddingPx=drawablePadding;
  hotseatIconSizePx=(int)(DynamicGrid.pxFromDp(hotseatIconSize,dm) * scale);
  searchBarSpaceWidthPx=Math.min(widthPx,res.getDimensionPixelSize(R.dimen.dynamic_grid_search_bar_max_width));
  searchBarSpaceHeightPx=getSearchBarTopOffset() + res.getDimensionPixelSize(R.dimen.dynamic_grid_search_bar_height);
  Paint textPaint=new Paint();
  textPaint.setTextSize(iconTextSizePx);
  FontMetrics fm=textPaint.getFontMetrics();
  cellWidthPx=iconSizePx;
  cellHeightPx=iconSizePx + iconDrawablePaddingPx + (int)Math.ceil(fm.bottom - fm.top);
  final float scaleDps=res.getDimensionPixelSize(R.dimen.dragViewScale);
  dragViewScale=(iconSizePx + scaleDps) / iconSizePx;
  hotseatBarHeightPx=iconSizePx + 4 * edgeMarginPx;
  hotseatCellWidthPx=iconSizePx;
  hotseatCellHeightPx=iconSizePx;
  folderCellWidthPx=cellWidthPx + 3 * edgeMarginPx;
  folderCellHeightPx=cellHeightPx + edgeMarginPx;
  folderBackgroundOffset=-edgeMarginPx;
  folderIconSizePx=iconSizePx + 2 * -folderBackgroundOffset;
  allAppsCellWidthPx=allAppsIconSizePx;
  allAppsCellHeightPx=allAppsIconSizePx + drawablePadding + iconTextSizePx;
  int maxLongEdgeCellCount=res.getInteger(R.integer.config_dynamic_grid_max_long_edge_cell_count);
  int maxShortEdgeCellCount=res.getInteger(R.integer.config_dynamic_grid_max_short_edge_cell_count);
  int minEdgeCellCount=res.getInteger(R.integer.config_dynamic_grid_min_edge_cell_count);
  int maxRows=(isLandscape ? maxShortEdgeCellCount : maxLongEdgeCellCount);
  int maxCols=(isLandscape ? maxLongEdgeCellCount : maxShortEdgeCellCount);
  if (allAppsShortEdgeCount > 0 && allAppsLongEdgeCount > 0) {
    allAppsNumRows=isLandscape ? allAppsShortEdgeCount : allAppsLongEdgeCount;
    allAppsNumCols=isLandscape ? allAppsLongEdgeCount : allAppsShortEdgeCount;
  }
 else {
    allAppsNumRows=(availableHeightPx - pageIndicatorHeightPx) / (allAppsCellHeightPx + allAppsCellPaddingPx);
    allAppsNumRows=Math.max(minEdgeCellCount,Math.min(maxRows,allAppsNumRows));
    allAppsNumCols=(availableWidthPx) / (allAppsCellWidthPx + allAppsCellPaddingPx);
    allAppsNumCols=Math.max(minEdgeCellCount,Math.min(maxCols,allAppsNumCols));
  }
  int appsContainerViewPx=res.getDimensionPixelSize(R.dimen.apps_container_width);
  int appsViewLeftMarginPx=res.getDimensionPixelSize(R.dimen.apps_grid_view_start_margin);
  int availableAppsWidthPx=(appsContainerViewPx > 0) ? appsContainerViewPx : availableWidthPx;
  appsViewNumCols=(availableAppsWidthPx - appsViewLeftMarginPx) / (allAppsCellWidthPx + 2 * allAppsCellPaddingPx);
}
