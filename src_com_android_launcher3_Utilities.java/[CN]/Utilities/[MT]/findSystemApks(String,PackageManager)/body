{
  final Intent intent=new Intent(action);
  List<Pair<String,Resources>> systemApks=new ArrayList<Pair<String,Resources>>();
  for (  ResolveInfo info : pm.queryBroadcastReceivers(intent,0)) {
    if (info.activityInfo != null && (info.activityInfo.applicationInfo.flags & ApplicationInfo.FLAG_SYSTEM) != 0) {
      final String packageName=info.activityInfo.packageName;
      try {
        final Resources res=pm.getResourcesForApplication(packageName);
        systemApks.add(Pair.create(packageName,res));
      }
 catch (      NameNotFoundException e) {
        Log.w(TAG,"Failed to find resources for " + packageName);
      }
    }
  }
  return systemApks;
}
