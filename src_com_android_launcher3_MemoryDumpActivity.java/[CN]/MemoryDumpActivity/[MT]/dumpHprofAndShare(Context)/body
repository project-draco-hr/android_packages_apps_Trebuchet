{
  try {
    final String path=String.format("%s/launcher-memory-%d.ahprof",Environment.getExternalStorageDirectory(),System.currentTimeMillis());
    Log.v(Launcher.TAG,"Dumping memory info to " + path);
    android.os.Debug.dumpHprofData(path);
    Intent shareIntent=new Intent(Intent.ACTION_SEND);
    shareIntent.setType("application/vnd.android.bugreport");
    final long pss=Debug.getPss();
    final PackageManager pm=context.getPackageManager();
    shareIntent.putExtra(Intent.EXTRA_SUBJECT,String.format("Launcher memory dump (PSS=%d)",pss));
    String appVersion;
    try {
      appVersion=pm.getPackageInfo(context.getPackageName(),0).versionName;
    }
 catch (    PackageManager.NameNotFoundException e) {
      appVersion="?";
    }
    shareIntent.putExtra(Intent.EXTRA_TEXT,String.format("App version: %s\nBuild: %s",appVersion,Build.DISPLAY));
    shareIntent.setType("application/vnd.android.hprof");
    final File pathFile=new File(path);
    final Uri pathUri=Uri.fromFile(pathFile);
    shareIntent.putExtra(Intent.EXTRA_STREAM,pathUri);
    context.startActivity(shareIntent);
  }
 catch (  IOException e) {
    e.printStackTrace();
  }
}
