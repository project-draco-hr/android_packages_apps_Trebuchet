{
  mRunning=true;
  android.os.Process.setThreadPriority(Process.THREAD_PRIORITY_BACKGROUND);
  final Intent mainIntent=new Intent(Intent.ACTION_MAIN,null);
  mainIntent.addCategory(Intent.CATEGORY_LAUNCHER);
  final Launcher launcher=mLauncher.get();
  final PackageManager manager=launcher.getPackageManager();
  final List<ResolveInfo> apps=manager.queryIntentActivities(mainIntent,0);
  if (apps != null && !mStopped) {
    final int count=apps.size();
    final ApplicationsAdapter applicationList=mApplicationsAdapter;
    ChangeNotifier action=new ChangeNotifier(applicationList,true);
    final HashMap<ComponentName,ApplicationInfo> appInfoCache=mAppInfoCache;
    for (int i=0; i < count && !mStopped; i++) {
      ResolveInfo info=apps.get(i);
      ApplicationInfo application=makeAndCacheApplicationInfo(manager,appInfoCache,info,launcher);
      if (action.add(application) && !mStopped) {
        launcher.runOnUiThread(action);
        action=new ChangeNotifier(applicationList,false);
      }
    }
    launcher.runOnUiThread(action);
  }
  if (!mStopped) {
    mApplicationsLoaded=true;
  }
  mRunning=false;
}
