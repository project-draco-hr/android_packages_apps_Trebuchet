{
  setup();
  try {
    mAllApps=(AllAppsPagedView)findViewById(R.id.all_apps_paged_view);
    if (mAllApps == null)     throw new Resources.NotFoundException();
    mBackground=(AllAppsBackground)findViewById(R.id.all_apps_background);
    if (mBackground == null)     throw new Resources.NotFoundException();
  }
 catch (  Resources.NotFoundException e) {
    Log.e(TAG,"Can't find necessary layout elements for AllAppsTabbed");
  }
  TabContentFactory contentFactory=new TabContentFactory(){
    public View createTabContent(    String tag){
      return mAllApps;
    }
  }
;
  AllAppsTabKeyEventListener keyListener=new AllAppsTabKeyEventListener();
  TextView tabView;
  TabWidget tabWidget=(TabWidget)findViewById(com.android.internal.R.id.tabs);
  tabView=(TextView)mInflater.inflate(R.layout.tab_widget_indicator,tabWidget,false);
  tabView.setText(mContext.getString(R.string.all_apps_tab_all));
  addTab(newTabSpec(TAG_ALL).setIndicator(tabView).setContent(contentFactory));
  tabView=(TextView)mInflater.inflate(R.layout.tab_widget_indicator,tabWidget,false);
  tabView.setText(mContext.getString(R.string.all_apps_tab_downloaded));
  addTab(newTabSpec(TAG_DOWNLOADED).setIndicator(tabView).setContent(contentFactory));
  View lastTab=tabWidget.getChildTabViewAt(tabWidget.getTabCount() - 1);
  lastTab.setOnKeyListener(keyListener);
  View shopButton=findViewById(R.id.market_button);
  shopButton.setOnKeyListener(keyListener);
  setOnTabChangedListener(new OnTabChangeListener(){
    public void onTabChanged(    String tabId){
      final Resources res=getResources();
      final int duration=res.getInteger(R.integer.config_tabTransitionTime);
      final float alpha=mAllApps.getAlpha();
      ValueAnimator alphaAnim=ObjectAnimator.ofFloat(mAllApps,"alpha",alpha,0.0f).setDuration(duration);
      alphaAnim.addListener(new AnimatorListenerAdapter(){
        @Override public void onAnimationEnd(        Animator animation){
          String tag=getCurrentTabTag();
          if (tag == TAG_ALL) {
            mAllApps.setAppFilter(AllAppsPagedView.ALL_APPS_FLAG);
          }
 else           if (tag == TAG_DOWNLOADED) {
            mAllApps.setAppFilter(ApplicationInfo.DOWNLOADED_FLAG);
          }
          final float alpha=mAllApps.getAlpha();
          ObjectAnimator.ofFloat(mAllApps,"alpha",alpha,1.0f).setDuration(duration).start();
        }
      }
);
      alphaAnim.start();
    }
  }
);
  int pageWidth=mAllApps.getPageContentWidth();
  View allAppsTabBar=(View)findViewById(R.id.all_apps_tab_bar);
  if (allAppsTabBar == null)   throw new Resources.NotFoundException();
  int tabWidgetPadding=0;
  final int childCount=tabWidget.getChildCount();
  if (childCount > 0) {
    tabWidgetPadding+=tabWidget.getChildAt(0).getPaddingLeft() * 2;
  }
  allAppsTabBar.getLayoutParams().width=pageWidth + tabWidgetPadding;
  setVisibility(INVISIBLE);
}
