{
  if (getChildCount() <= 1) {
    return 0;
  }
  final int firstIndex=isLayoutRtl() ? getChildCount() - 2 : 1;
  int extra=numExtraScreensToIgnore();
  final int lastIndex=isLayoutRtl() ? 0 + extra : getChildCount() - 1 - extra;
  int firstPageScrollX=getScrollForPage(firstIndex);
  int scrollRange=getScrollForPage(lastIndex) - firstPageScrollX;
  if (scrollRange == 0) {
    return 0;
  }
 else {
    float offset=Math.min(1,(getScrollX() - firstPageScrollX) / (float)scrollRange);
    offset=Math.max(0,offset);
    int numScrollingPages=getNumScreensExcludingExtraEmptyScreenAndLeftmost();
    int parallaxPageSpan=Math.max(MIN_PARALLAX_PAGE_SPAN,numScrollingPages) - 1;
    return offset * (numScrollingPages - 1) / parallaxPageSpan;
  }
}
