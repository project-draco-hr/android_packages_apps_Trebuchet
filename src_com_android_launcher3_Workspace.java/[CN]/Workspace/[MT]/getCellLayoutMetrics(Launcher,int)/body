{
  LauncherAppState app=LauncherAppState.getInstance();
  DeviceProfile grid=app.getDynamicGrid().getDeviceProfile();
  Display display=launcher.getWindowManager().getDefaultDisplay();
  Point smallestSize=new Point();
  Point largestSize=new Point();
  display.getCurrentSizeRange(smallestSize,largestSize);
  int countX=(int)grid.numColumns;
  int countY=(int)grid.numRows;
  if (orientation == CellLayout.LANDSCAPE) {
    if (mLandscapeCellLayoutMetrics == null) {
      Rect padding=grid.getWorkspacePadding(CellLayout.LANDSCAPE);
      int width=largestSize.x - padding.left - padding.right;
      int height=smallestSize.y - padding.top - padding.bottom;
      mLandscapeCellLayoutMetrics=new Rect();
      mLandscapeCellLayoutMetrics.set(grid.calculateCellWidth(width,countX),grid.calculateCellHeight(height,countY),0,0);
    }
    return mLandscapeCellLayoutMetrics;
  }
 else   if (orientation == CellLayout.PORTRAIT) {
    if (mPortraitCellLayoutMetrics == null) {
      Rect padding=grid.getWorkspacePadding(CellLayout.PORTRAIT);
      int width=smallestSize.x - padding.left - padding.right;
      int height=largestSize.y - padding.top - padding.bottom;
      mPortraitCellLayoutMetrics=new Rect();
      mPortraitCellLayoutMetrics.set(grid.calculateCellWidth(width,countX),grid.calculateCellHeight(height,countY),0,0);
    }
    return mPortraitCellLayoutMetrics;
  }
  return null;
}
