{
  int count=cl.getShortcutsAndWidgets().getChildCount();
  ArrayList<View> children=new ArrayList<View>();
  for (int i=0; i < count; i++) {
    View v=cl.getShortcutsAndWidgets().getChildAt(i);
    children.add(v);
  }
  for (int i=0; i < count; i++) {
    View v=children.get(i);
    ItemInfo info=(ItemInfo)v.getTag();
    if (info instanceof ShortcutInfo) {
      ShortcutInfo si=(ShortcutInfo)info;
      ComponentName cn=si.intent.getComponent();
      if (si.itemType == LauncherSettings.Favorites.ITEM_TYPE_SHORTCUT) {
        continue;
      }
      if (!uniqueIntents.contains(cn)) {
        uniqueIntents.add(cn);
      }
 else {
        cl.removeViewInLayout(v);
        LauncherModel.deleteItemFromDatabase(mLauncher,si);
      }
    }
    if (v instanceof FolderIcon) {
      FolderIcon fi=(FolderIcon)v;
      ArrayList<View> items=fi.getFolder().getItemsInReadingOrder();
      for (int j=0; j < items.size(); j++) {
        if (items.get(j).getTag() instanceof ShortcutInfo) {
          ShortcutInfo si=(ShortcutInfo)items.get(j).getTag();
          ComponentName cn=si.intent.getComponent();
          if (si.itemType == LauncherSettings.Favorites.ITEM_TYPE_SHORTCUT) {
            continue;
          }
          if (!uniqueIntents.contains(cn)) {
            uniqueIntents.add(cn);
          }
 else {
            fi.getFolderInfo().remove(si);
            LauncherModel.deleteItemFromDatabase(mLauncher,si);
          }
        }
      }
    }
  }
}
