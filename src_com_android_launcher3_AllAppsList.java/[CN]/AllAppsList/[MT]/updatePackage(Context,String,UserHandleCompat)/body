{
  final LauncherAppsCompat launcherApps=LauncherAppsCompat.getInstance(context);
  final List<LauncherActivityInfoCompat> matches=launcherApps.getActivityList(packageName,user);
  if (matches.size() > 0) {
    for (int i=data.size() - 1; i >= 0; i--) {
      final AppInfo applicationInfo=data.get(i);
      final ComponentName component=applicationInfo.intent.getComponent();
      if (user.equals(applicationInfo.user) && packageName.equals(component.getPackageName())) {
        if (!findActivity(matches,component)) {
          removed.add(applicationInfo);
          mIconCache.remove(component,user);
          data.remove(i);
        }
      }
    }
    int count=matches.size();
    for (int i=0; i < count; i++) {
      final LauncherActivityInfoCompat info=matches.get(i);
      AppInfo applicationInfo=findApplicationInfoLocked(info.getComponentName().getPackageName(),user,info.getComponentName().getShortClassName());
      if (applicationInfo == null) {
        add(new AppInfo(context,info,user,mIconCache,null));
      }
 else {
        mIconCache.remove(applicationInfo.componentName,user);
        mIconCache.getTitleAndIcon(applicationInfo,info,null);
        modified.add(applicationInfo);
      }
    }
  }
 else {
    for (int i=data.size() - 1; i >= 0; i--) {
      final AppInfo applicationInfo=data.get(i);
      final ComponentName component=applicationInfo.intent.getComponent();
      if (user.equals(applicationInfo.user) && packageName.equals(component.getPackageName())) {
        removed.add(applicationInfo);
        mIconCache.remove(component,user);
        data.remove(i);
      }
    }
  }
}
