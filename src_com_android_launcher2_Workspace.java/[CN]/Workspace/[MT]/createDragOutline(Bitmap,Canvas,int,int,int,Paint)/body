{
  final int outlineColor=getResources().getColor(android.R.color.holo_blue_light);
  final Bitmap b=Bitmap.createBitmap(w,h,Bitmap.Config.ARGB_8888);
  canvas.setBitmap(b);
  Rect src=new Rect(0,0,orig.getWidth(),orig.getHeight());
  float scaleFactor=Math.min((w - padding) / (float)orig.getWidth(),(h - padding) / (float)orig.getHeight());
  int scaledWidth=(int)(scaleFactor * orig.getWidth());
  int scaledHeight=(int)(scaleFactor * orig.getHeight());
  Rect dst=new Rect(0,0,scaledWidth,scaledHeight);
  dst.offset((w - scaledWidth) / 2,(h - scaledHeight) / 2);
  canvas.drawBitmap(orig,src,dst,null);
  mOutlineHelper.applyMediumExpensiveOutlineWithBlur(b,canvas,outlineColor,outlineColor,alphaClipPaint);
  canvas.setBitmap(null);
  return b;
}
