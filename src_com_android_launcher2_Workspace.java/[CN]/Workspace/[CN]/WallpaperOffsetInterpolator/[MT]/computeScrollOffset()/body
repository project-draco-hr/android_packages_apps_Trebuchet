{
  if (Float.compare(mHorizontalWallpaperOffset,mFinalHorizontalWallpaperOffset) == 0 && Float.compare(mVerticalWallpaperOffset,mFinalVerticalWallpaperOffset) == 0) {
    mIsMovingFast=false;
    return false;
  }
  boolean isLandscape=mDisplayWidth > mDisplayHeight;
  long currentTime=System.currentTimeMillis();
  long timeSinceLastUpdate=currentTime - mLastWallpaperOffsetUpdateTime;
  timeSinceLastUpdate=Math.min((long)(1000 / 30f),timeSinceLastUpdate);
  timeSinceLastUpdate=Math.max(1L,timeSinceLastUpdate);
  float xdiff=Math.abs(mFinalHorizontalWallpaperOffset - mHorizontalWallpaperOffset);
  if (!mIsMovingFast && xdiff > 0.07) {
    mIsMovingFast=true;
  }
  float fractionToCatchUpIn1MsHorizontal;
  if (mOverrideHorizontalCatchupConstant) {
    fractionToCatchUpIn1MsHorizontal=mHorizontalCatchupConstant;
  }
 else   if (mIsMovingFast) {
    fractionToCatchUpIn1MsHorizontal=isLandscape ? 0.5f : 0.75f;
  }
 else {
    fractionToCatchUpIn1MsHorizontal=isLandscape ? 0.27f : 0.5f;
  }
  float fractionToCatchUpIn1MsVertical=mVerticalCatchupConstant;
  fractionToCatchUpIn1MsHorizontal/=33f;
  fractionToCatchUpIn1MsVertical/=33f;
  final float UPDATE_THRESHOLD=0.00001f;
  float hOffsetDelta=mFinalHorizontalWallpaperOffset - mHorizontalWallpaperOffset;
  float vOffsetDelta=mFinalVerticalWallpaperOffset - mVerticalWallpaperOffset;
  boolean jumpToFinalValue=Math.abs(hOffsetDelta) < UPDATE_THRESHOLD && Math.abs(vOffsetDelta) < UPDATE_THRESHOLD;
  if (jumpToFinalValue) {
    mHorizontalWallpaperOffset=mFinalHorizontalWallpaperOffset;
    mVerticalWallpaperOffset=mFinalVerticalWallpaperOffset;
  }
 else {
    float percentToCatchUpVertical=Math.min(1.0f,timeSinceLastUpdate * fractionToCatchUpIn1MsVertical);
    float percentToCatchUpHorizontal=Math.min(1.0f,timeSinceLastUpdate * fractionToCatchUpIn1MsHorizontal);
    mHorizontalWallpaperOffset+=percentToCatchUpHorizontal * hOffsetDelta;
    mVerticalWallpaperOffset+=percentToCatchUpVertical * vOffsetDelta;
  }
  mLastWallpaperOffsetUpdateTime=System.currentTimeMillis();
  return true;
}
