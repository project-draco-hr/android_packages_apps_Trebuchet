{
  item.container=container;
  item.cellX=cellX;
  item.cellY=cellY;
  if (context instanceof Launcher && screen < 0 && container == LauncherSettings.Favorites.CONTAINER_HOTSEAT) {
    item.screen=((Launcher)context).getHotseat().getOrderInHotseat(cellX,cellY);
  }
 else {
    item.screen=screen;
  }
  final ContentValues values=new ContentValues();
  final ContentResolver cr=context.getContentResolver();
  item.onAddToDatabase(values);
  LauncherApplication app=(LauncherApplication)context.getApplicationContext();
  item.id=app.getLauncherProvider().generateNewId();
  values.put(LauncherSettings.Favorites._ID,item.id);
  item.updateValuesWithCoordinates(values,item.cellX,item.cellY);
  final StackTraceElement[] stackTrace=new Throwable().getStackTrace();
  Runnable r=new Runnable(){
    public void run(){
      String transaction="DbDebug    Add item (" + item.title + ") to db, id: "+ item.id+ " ("+ container+ ", "+ screen+ ", "+ cellX+ ", "+ cellY+ ")";
      Launcher.sDumpLogs.add(transaction);
      Log.d(TAG,transaction);
      cr.insert(notify ? LauncherSettings.Favorites.CONTENT_URI : LauncherSettings.Favorites.CONTENT_URI_NO_NOTIFICATION,values);
synchronized (mBgLock) {
        if (sBgItemsIdMap.containsKey(item.id)) {
          throw new RuntimeException("Error: ItemInfo id (" + item.id + ") passed to "+ "addItemToDatabase already exists."+ item.toString());
        }
        sBgItemsIdMap.put(item.id,item);
switch (item.itemType) {
case LauncherSettings.Favorites.ITEM_TYPE_FOLDER:
          sBgFolders.put(item.id,(FolderInfo)item);
case LauncherSettings.Favorites.ITEM_TYPE_APPLICATION:
case LauncherSettings.Favorites.ITEM_TYPE_SHORTCUT:
        if (item.container == LauncherSettings.Favorites.CONTAINER_DESKTOP || item.container == LauncherSettings.Favorites.CONTAINER_HOTSEAT) {
          sBgWorkspaceItems.add(item);
        }
 else {
          if (!sBgFolders.containsKey(item.container)) {
            String msg="adding item: " + item + " to a folder that "+ " doesn't exist";
            RuntimeException e=new RuntimeException(msg);
            e.setStackTrace(stackTrace);
            Launcher.dumpDebugLogsToConsole();
            throw e;
          }
        }
      break;
case LauncherSettings.Favorites.ITEM_TYPE_APPWIDGET:
    sBgAppWidgets.add((LauncherAppWidgetInfo)item);
  break;
}
}
}
}
;
runOnWorkerThread(r);
}
