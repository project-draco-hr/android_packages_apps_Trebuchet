{
  final LauncherAppWidgetProviderInfo info=LauncherModel.getProviderInfo(mContext,provider,user);
  Widget widget=new Widget();
  widget.provider=provider.flattenToShortString();
  widget.label=info.label;
  widget.configure=info.configure != null;
  if (info.icon != 0) {
    widget.icon=new Resource();
    Drawable fullResIcon=iconCache.getFullResIcon(provider.getPackageName(),info.icon);
    Bitmap icon=Utilities.createIconBitmap(fullResIcon,mContext);
    widget.icon.data=Utilities.flattenBitmap(icon);
    widget.icon.dpi=dpi;
  }
  if (info.previewImage != 0) {
    widget.preview=new Resource();
    Bitmap preview=previewLoader.generateWidgetPreview(info,previewWidth,null);
    widget.preview.data=Utilities.flattenBitmap(preview);
    widget.preview.dpi=dpi;
  }
  return widget;
}
