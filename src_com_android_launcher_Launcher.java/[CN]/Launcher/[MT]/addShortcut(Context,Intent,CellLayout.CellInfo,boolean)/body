{
  Intent intent=data.getParcelableExtra(Intent.EXTRA_SHORTCUT_INTENT);
  String name=data.getStringExtra(Intent.EXTRA_SHORTCUT_NAME);
  Bitmap bitmap=data.getParcelableExtra(Intent.EXTRA_SHORTCUT_ICON);
  Drawable icon=null;
  boolean filtered=false;
  boolean customIcon=false;
  Intent.ShortcutIconResource iconResource=null;
  if (bitmap != null) {
    icon=new FastBitmapDrawable(Utilities.createBitmapThumbnail(bitmap,context));
    filtered=true;
    customIcon=true;
  }
 else {
    Parcelable extra=data.getParcelableExtra(Intent.EXTRA_SHORTCUT_ICON_RESOURCE);
    if (extra != null && extra instanceof Intent.ShortcutIconResource) {
      try {
        iconResource=(Intent.ShortcutIconResource)extra;
        final PackageManager packageManager=context.getPackageManager();
        Resources resources=packageManager.getResourcesForApplication(iconResource.packageName);
        final int id=resources.getIdentifier(iconResource.resourceName,null,null);
        icon=resources.getDrawable(id);
      }
 catch (      Exception e) {
        w(LOG_TAG,"Could not load shortcut icon: " + extra);
      }
    }
  }
  if (icon == null) {
    icon=context.getPackageManager().getDefaultActivityIcon();
  }
  final ApplicationInfo info=new ApplicationInfo();
  info.icon=icon;
  info.filtered=filtered;
  info.title=name;
  info.intent=intent;
  info.customIcon=customIcon;
  info.iconResource=iconResource;
  LauncherModel.addItemToDatabase(context,info,LauncherSettings.Favorites.CONTAINER_DESKTOP,cellInfo.screen,cellInfo.cellX,cellInfo.cellY,notify);
  return info;
}
